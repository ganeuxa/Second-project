<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–¢–æ–≤–∞—Ä—ã</title>
  <link rel="stylesheet" href="../style/styles.css">

  <!-- –°—Ç–∏–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
  <style>
    dialog::backdrop {
      background: rgba(0, 0, 0, 0.7);
      animation: fadeIn 0.3s ease;
    }

    dialog#productModal {
      border: none;
      border-radius: 12px;
      padding: 0;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
      animation: slideIn 0.3s ease;
      max-width: 90vw;
      max-height: 90vh;
      width: auto;
      overflow: hidden;
      background: var(--color-bg);
      color: var(--color-fg);
    }

    .modal-header {
      position: relative;
      padding: 1rem 1rem 1rem 2rem;
      border-bottom: 1px solid var(--color-bg-alt);
    }

    .modal-close {
      position: absolute;
      top: 0.75rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--color-muted);
      cursor: pointer;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: var(--transition);
    }

    .modal-close:hover {
      background: var(--color-bg-alt);
      color: var(--color-fg);
    }

    .modal-body {
      display: flex;
      flex-direction: column;
      padding: 1.5rem 2rem 2rem 2rem;
      gap: 1.5rem;
    }

    @media (min-width: 768px) {
      .modal-body {
        flex-direction: row;
        gap: 2rem;
      }

      .modal-image {
        flex: 0 0 300px;
      }
    }

    .modal-image img {
      width: 100%;
      max-height: 50vh;
      object-fit: contain;
      border-radius: 8px;
      background: var(--color-bg-alt);
    }

    .modal-content {
      flex: 1;
    }

    .modal-title {
      font-size: var(--font-size-h2);
      margin: 0 0 0.75rem 0;
      color: var(--color-fg);
    }

    .modal-text {
      color: var(--color-muted);
      line-height: 1.6;
      margin: 0 0 1rem 0;
    }

    .modal-price {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--color-accent);
      margin: 0.5rem 0;
    }

    .modal-price--old {
      text-decoration: line-through;
      color: var(--color-muted);
      font-size: 1.2rem;
      margin-right: 0.5rem;
    }

    .modal-discount {
      color: var(--color-discount);
      font-weight: 600;
      margin-top: 0.5rem;
      font-size: 1rem;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
  </style>
</head>
<body>
  <button class="theme-toggle" id="themeToggle">–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É</button>

  <div class="page">
    <header class="header">
      <h1 class="header__title">–¢–æ–≤–∞—Ä—ã</h1>
    </header>

    <nav class="nav">
      <ul class="nav__list">
        <li class="nav__item"><a class="nav__link" href="../index_v1.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li class="nav__item"><a class="nav__link" href="news_v1.html">–ù–æ–≤–æ—Å—Ç–∏</a></li>
        <li class="nav__item nav__item--active"><a class="nav__link" href="goods_v1.html">–¢–æ–≤–∞—Ä—ã</a></li>
        <li class="nav__item"><a class="nav__link" href="contacts_v1.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
      </ul>
    </nav>

    <main class="main">
      <div class="products__grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; margin-top: 30px;">
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 1 -->
        <article class="product-card" data-product='{"title":"–ü–æ–¥–º–µ—Ç–∞–ø–∫–∏","image":"../images/Podmetapki.png","desc":"–ñ–µ–Ω–∞ —É—Ä–æ–Ω–∏—Ç —á–µ–ª—é—Å—Ç—å –æ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞","price":"25 000 —Ä—É–±."}'>
          <img class="product-card__image" src="../images/Podmetapki.png" alt="–ü–æ–¥–º–µ—Ç–∞–ø–∫–∏">
          <h2 class="product-card__title">–ü–æ–¥–º–µ—Ç–∞–ø–∫–∏</h2>
          <p class="product-card__text">–ñ–µ–Ω–∞ —É—Ä–æ–Ω–∏—Ç —á–µ–ª—é—Å—Ç—å –æ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞</p>
          <p class="product-card__price">25 000 —Ä—É–±.</p>
        </article>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 2 -->
        <article class="product-card" data-product='{"title":"–ö—Ä—É–≥–ª—ã–π –∫—É–±–∏–∫","image":"../images/KrugliKubik.jpg","desc":"–ò –Ω–µ—Ç, –≤—Å–µ–ª–µ–Ω–Ω–∞—è –Ω–µ —Å—Ö–ª–æ–ø–Ω—É–ª–∞—Å—å","price":"5 000 —Ä—É–±."}'>
          <img class="product-card__image" src="../images/KrugliKubik.jpg" alt="–ö—Ä—É–≥–ª—ã–π –∫—É–±–∏–∫">
          <h2 class="product-card__title">–ö—Ä—É–≥–ª—ã–π –∫—É–±–∏–∫</h2>
          <p class="product-card__text">–ò –Ω–µ—Ç, –≤—Å–µ–ª–µ–Ω–Ω–∞—è –Ω–µ —Å—Ö–ª–æ–ø–Ω—É–ª–∞—Å—å</p>
          <p class="product-card__price">5 000 —Ä—É–±.</p>
        </article>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 3 ‚Äî —Å–æ —Å–∫–∏–¥–∫–æ–π -->
        <article class="product-card product-card--discount" data-product='{"title":"–≠–ª–µ–∫—Ç—Ä–æ–º–æ–ª–æ—Ç–æ–∫","image":"../images/Molotochek.jpg","desc":"–° –ø–æ–¥–æ–≥—Ä–µ–≤–æ–º —Ä—É—á–∫–∏","price":"800 —Ä—É–±.","oldPrice":"801 —Ä—É–±.","discountText":"–í—ã —ç–∫–æ–Ω–æ–º–∏—Ç–µ —Ü–µ–ª—ã–π 1 —Ä—É–±–ª—å!"}'>
          <img class="product-card__image" src="../images/Molotochek.jpg" alt="–≠–ª–µ–∫—Ç—Ä–æ–º–æ–ª–æ—Ç–æ–∫">
          <h2 class="product-card__title">–≠–ª–µ–∫—Ç—Ä–æ–º–æ–ª–æ—Ç–æ–∫</h2>
          <p class="product-card__text">–° –ø–æ–¥–æ–≥—Ä–µ–≤–æ–º —Ä—É—á–∫–∏</p>
          <p>
            <del class="product-card__price--old">801 —Ä—É–±.</del>
            <span class="product-card__price">800 —Ä—É–±.</span>
          </p>
        </article>
      </div>
    </main>

    <footer class="footer">
      <p class="footer__text">–§—É—Ç–µ—Ä</p>
    </footer>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç–æ–≤–∞—Ä–∞ -->
  <dialog id="productModal">
    <div class="modal-header">
      <button class="modal-close" id="modalCloseBtn">&times;</button>
    </div>
    <div class="modal-body">
      <div class="modal-image">
        <img id="modalImage" src="" alt="">
      </div>
      <div class="modal-content">
        <h2 class="modal-title" id="modalTitle"></h2>
        <p class="modal-text" id="modalText"></p>
        <div>
          <span id="modalOldPrice" class="modal-price--old"></span>
          <span id="modalPrice" class="modal-price"></span>
        </div>
        <p id="modalDiscount" class="modal-discount"></p>
      </div>
    </div>
  </dialog>

  <script>
    // === –°–º–µ–Ω–∞ —Ç–µ–º—ã ===
    const toggle = document.getElementById('themeToggle');
    const KEY = 'theme';
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const savedTheme = localStorage.getItem(KEY);
    if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
      document.body.classList.add('theme-dark');
      toggle.textContent = '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
    }
    toggle.addEventListener('click', () => {
      const isDark = document.body.classList.toggle('theme-dark');
      localStorage.setItem(KEY, isDark ? 'dark' : 'light');
      toggle.textContent = isDark ? '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞' : '–¢—ë–º–Ω–∞—è —Ç–µ–º–∞';
    });

    // === –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç–æ–≤–∞—Ä–∞ ===
    const modal = document.getElementById('productModal');

    function openModal(data) {
      const modalImage = document.getElementById('modalImage');
      const modalTitle = document.getElementById('modalTitle');
      const modalText = document.getElementById('modalText');
      const modalPrice = document.getElementById('modalPrice');
      const modalOldPrice = document.getElementById('modalOldPrice');
      const modalDiscount = document.getElementById('modalDiscount');

      modalImage.src = data.image;
      modalImage.alt = data.title;
      modalTitle.textContent = data.title;
      modalText.textContent = data.desc;
      modalPrice.textContent = data.price || '';
      modalOldPrice.textContent = data.oldPrice || '';
      modalDiscount.textContent = data.discountText || '';

      document.body.style.overflow = 'hidden'; // üîí –±–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
      modal.showModal();
    }

    function closeModal() {
      modal.close();
    }

    document.querySelectorAll('.product-card').forEach(card => {
      card.addEventListener('click', () => {
        const data = JSON.parse(card.getAttribute('data-product'));
        openModal(data);
      });
    });

    // –ö—Ä–µ—Å—Ç–∏–∫–∏ –∏ –ø–æ–¥–ª–æ–∂–∫–∞
    document.getElementById('modalCloseBtn').addEventListener('click', closeModal);

    modal.addEventListener('click', (e) => {
      const rect = modal.getBoundingClientRect();
      const isInDialog = (
        rect.top <= e.clientY &&
        e.clientY <= rect.top + rect.height &&
        rect.left <= e.clientX &&
        e.clientX <= rect.left + rect.width
      );
      if (!isInDialog) {
        closeModal();
      }
    });

    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
    modal.addEventListener('close', () => {
      document.body.style.overflow = ''; // üîì —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
    });
  </script>
</body>
</html>